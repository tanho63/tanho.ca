---
layout: single
title: "Advent of Code, Day 3"
date:   2020-12-03
summary: "Tackling day three of Advent of Code - toboggan paths!"
type: rshiny
menu:
  sidebar:
    name: AdventofCode-03
    identifier: adventcode2020-3
    parent: rshiny
url: /adventcode-2020-03
hero: /images/rshiny/advent.jpg
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Day three!</p>
<pre class="r"><code>library(tidyverse)
library(here)

knitr::opts_chunk$set(echo = TRUE)</code></pre>
<div id="problem" class="section level3">
<h3>Problem</h3>
<blockquote>
<p>You start on the open square (.) in the top-left corner and need to reach the bottom (below the bottom-most row on your map).</p>
<p>The toboggan can only follow a few specific slopes (you opted for a cheaper model that prefers rational numbers); start by counting all the trees you would encounter for the slope right 3, down 1:</p>
<p>From your starting position at the top-left, check the position that is right 3 and down 1. Then, check the position that is right 3 and down 1 from there, and so on until you go past the bottom of the map.</p>
<p>Starting at the top-left corner of your map and following a slope of right 3 and down 1, how many trees would you encounter?</p>
</blockquote>
</div>
<div id="input-data" class="section level3">
<h3>Input Data</h3>
<p>(You can get a copy of my data at <a href="https://github.com/tanho63/advent_of_code/blob/master/2020/day-04.txt" class="uri">https://github.com/tanho63/advent_of_code/blob/master/2020/day-04.txt</a>)</p>
<p>Converting to a matrix of 1s and 0s, where “#” is 1 and “.” is 0</p>
<pre class="r"><code>input_matrix &lt;- read_table(&quot;day-03.txt&quot;,col_names = &quot;x&quot;) %&gt;% 
  mutate(x = str_split(x,&quot;&quot;)) %&gt;% 
  unnest_wider(x,names_sep = &quot;_&quot;) %&gt;% 
  mutate_all(~case_when(.x == &quot;#&quot; ~ 1, .x == &quot;.&quot; ~ 0)) %&gt;% 
  as.matrix()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   x = col_character()
## )</code></pre>
</div>
<div id="problem-1" class="section level3">
<h3>Problem 1</h3>
<blockquote>
<p>Starting at the top-left corner of your map and following a slope of right 3 and down 1, how many trees would you encounter?</p>
</blockquote>
<p>So the pattern repeats to the right until you get down to the bottom, i.e. until you access row 323 in this case.</p>
<pre class="r"><code>input_rows &lt;- nrow(input_matrix)

input_rows</code></pre>
<pre><code>## [1] 323</code></pre>
<p>323 is the goal rows, and that means we’ll need ~ 969 columns. Tackling this via cbind + a while loop.</p>
<pre class="r"><code>input_columns &lt;- input_rows * 3

wide_matrix &lt;- input_matrix

while(ncol(wide_matrix) &lt; input_columns) wide_matrix &lt;- cbind(wide_matrix,input_matrix)</code></pre>
<p>Now building an accessor tibble with row numbers and column numbers</p>
<pre class="r"><code>row_accessor &lt;- 2:input_rows # start at 1,1 so the next row is 2

column_accessor &lt;- 1:input_rows * 3 + 1 # start at 1,1 and move right three, so next column is 4

column_accessor &lt;- column_accessor[-323] # need the accessors to be same length

indices &lt;- tibble(
  row = row_accessor,
  column = column_accessor) %&gt;%
  mutate(path = map2_dbl(row,column,~wide_matrix[.x,.y]))
  
head(indices)</code></pre>
<pre><code>## # A tibble: 6 x 3
##     row column  path
##   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1     2      4     1
## 2     3      7     1
## 3     4     10     1
## 4     5     13     1
## 5     6     16     1
## 6     7     19     1</code></pre>
<pre class="r"><code>sum(indices$path)</code></pre>
<pre><code>## [1] 280</code></pre>
</div>
<div id="problem-2-find-this-path-for-multiple-slopes" class="section level3">
<h3>Problem 2: Find this path for multiple slopes</h3>
<p>Find the path for</p>
<ul>
<li>1,1</li>
<li>3,1</li>
<li>5,1</li>
<li>7,1</li>
<li>1,2</li>
</ul>
<p>A good time to generalise the previous steps!</p>
<pre class="r"><code>fn_slope &lt;- function(right,down,matrix){
  
  # Calculate number of columns
  column_count &lt;- (nrow(matrix) * right)
  
  # Create matrix
  wide_matrix &lt;- matrix
  while(ncol(wide_matrix) &lt; column_count) wide_matrix &lt;- cbind(wide_matrix,matrix)
  
  # Create accessors
  row_accessor &lt;- (1:nrow(matrix) * down) + 1
  row_accessor &lt;- row_accessor[row_accessor &lt;=nrow(matrix)]
  
  column_accessor &lt;- (1:nrow(matrix) * right) + 1
  column_accessor &lt;- column_accessor[1:length(row_accessor)]
  
  x &lt;- tibble(row = row_accessor,
              column = column_accessor) %&gt;% 
    mutate(path = map2_dbl(row,column,~wide_matrix[.x,.y]))
  
  sum(x$path)
}

toboggan_paths &lt;- tibble(right = c(1,3,5,7,1),
                         down = c(1,1,1,1,2)) %&gt;% 
  mutate(paths = map2_dbl(right,down,fn_slope,input_matrix))

toboggan_paths</code></pre>
<pre><code>## # A tibble: 5 x 3
##   right  down paths
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     1    77
## 2     3     1   280
## 3     5     1    74
## 4     7     1    78
## 5     1     2    35</code></pre>
<pre class="r"><code>reduce(toboggan_paths$paths,`*`)</code></pre>
<pre><code>## [1] 4355551200</code></pre>
</div>
